---
title: 移动端 300 毫秒点击延迟
---

## 1. **问题由来**

2007年初。苹果公司在发布首款iPhone前夕，遇到一个问题：当时的网站都是为大屏幕设备所设计的。于是苹果的工程师做了一些约定，应对iPhone这种小屏幕浏览器桌面端站点的问题。

这当中最出名的，当属双击缩放，也就是300毫秒延迟的主要原因。

双击缩放，顾名思义，即用手指在屏幕上快速点击两次，iOS 自带的 Safari 浏览器会将网页缩放至原始比例。 由于用户可以进行双击缩放或者双击滚动的操作，当用户一次点击屏幕之后，浏览器并不能立刻判断用户是确实要打开这个链接，还是想要进行双击操作。因此，iOS Safari 就等待 300 毫秒，以判断用户是否再次点击了屏幕。鉴于 iPhone 的成功，其他移动浏览器都复制了 iPhone Safari 浏览器的多数约定，包括双击缩放。几乎现在所有的移动端浏览器都有这个功能。

## 2.**解决办法**

### 1）.浏览器开发商提供的解决方案

*  **禁用缩放**

   当HTML文档头部包含如下meta标签时：
    ```html
	<meta name="viewport" content="user-scalable=no">
	<meta name="viewport" content="initial-scale=1,maximum-scale=1">
	```
	表明这个页面是不可缩放的，那双击缩放的功能就没有意义了，此时浏览器可以禁用默认的双击缩放行为并且去掉300ms的点击延迟。
	
	注意：
	
	这个方案有一个缺点，就是必须通过完全禁用缩放来达到去掉点击延迟的目的，然而完全禁用缩放并不是我们的初衷，我们只是想禁掉默认的双击缩放行为，这样就不用等待300ms来判断当前操作是否是双击。但是通常情况下，我们还是希望页面能通过双指缩放来进行缩放操作，比如放大一张图片，放大一段很小的文字。

* **更改默认的视口宽度**

	移动端浏览器**默认的视口宽度**并不等于设备浏览器视窗宽度，而是要比设备浏览器视窗宽度大，通常是**980px**。
   ```html
   <meta name="viewport" content="width=device-width">
   ```
   这条代码告诉浏览器将视口大小设为设备本身的尺寸。
   
   在 Chrome 32 这一版中，他们将在包含 width=device-width 或者置为比 viewport 值更小的页面上禁用双击缩放。当然，没有双击缩放就没有 300 毫秒点击延迟。这一解决方案的另一个关键之处在于它只是去除了双击缩放，但用户仍可以使用双指缩放 (pinch to zoom)。可见，缩放功能并非被完全禁用，也就不存在可用性和可访问性的问题了。其它浏览器也相继支持这个
   
* **指针事件 (Pointer Events)**

  指针事件最初由微软提出。**touch-action**这个CSS属性。这个属性指定了相应元素上能够触发的用户代理（也就是浏览器）的默认行为。如果将该属性值设置为**touch-action: none**，那么表示在该元素上的操作不会触发用户代理的任何默认行为，就无需进行300ms的延迟判断。
  
  例如，下面的代码在 IE10 和 IE11 上移除了所有链接和按钮元素的点击延迟。
  ```css
  a[href], button {
    -ms-touch-action: none; /* IE10 */
    touch-action: none;     /* IE11 */
   }
  ```
  
  注意： 但就目前而言，只有 Internet Explorer 实现了指针事件，不过近期 Chrome 也宣布了将在未来的版本中提供支持。
  
### 2）.当前如何避免延迟

尽管浏览器开发商针对 300 毫秒延迟问题提出了一些解决方案，但目前并没有简单通用的方案。